我需要进行一次大幅度重构，以下需求以《2026-01-29-auto-symbol-refactor》为标准。

0.关键口径定义：
  - 仍有持仓：以 availableQuantity > 0 为准
  - 总持仓>0 且 availableQuantity=0：视为已有卖出挂单未成交
  - 席位为空：seatState.symbol 为 null 或状态为 EMPTY
  - 行情未就绪：席位已占用但尚未收到首个行情
  - 寻标成功：warrantList 筛选出最优标的且订阅成功
  - 换标成功/完成：寻标成功后 warrantQuote 刷新成功
  - 换标失败：warrantList 失败、订阅失败、撤单失败、warrantQuote 失败任一成立

1.静态标的移除与席位体系：
  - 所有模块统一从运行时席位读取标的，不再直接依赖配置中的长/短标的
  - 席位状态包含 READY/SEARCHING/SWITCHING/EMPTY
  - 席位版本号在换标时递增，延迟信号/队列任务/订单监控必须校验版本，不匹配直接丢弃并记录日志
  - 席位为空或处于 SWITCHING 时，信号生成、延迟验证、买卖处理器统一丢弃并记录日志

2.新增配置（每个监控标的独立）：
  - 自动寻标开关（仅牛熊证）。开启后忽略配置标的且不写回配置，仅更新运行时席位
  - 自动寻标条件：牛/熊分别配置最小价格阈值与分均成交额阈值（比较采用 >=）
  - 换标阈值：距回收价比值范围牛/熊分别配置，越界（包含等于）触发换标
  - 额外约束：到期日最小月份（默认 3）、开盘延迟分钟数（默认 5，仅上午开盘生效）
  - 自动寻标开关粒度为监控标的级别（做多/做空一起）
  - 自动寻标关闭但席位为空视为配置错误，阻止启动
  - 自动寻标开启时配置标的被忽略，不作为任何逻辑依据

3.自动寻标逻辑（以 warrantList 为准）：
  - 不分页，单次完整调用
  - 过滤：Normal 状态、牛/熊类型、到期月份满足阈值、turnover > 0
  - 价格 >= 最小价格阈值
  - 分均成交额 >= 阈值（分母为已开盘分钟数）
  - 过滤顺序：先价格阈值，再分均成交额阈值
  - 排序：价格最低优先，价格相同取分均成交额最高
  - 候选数量不限制，仅取最优一个；不做黑名单
  - 不使用发行商过滤、priceType 过滤、call_price/to_call_price 条件
  - warrantList 失败或无结果：席位保持空并记录日志（每次失败都记录）

4.启动流程（全量订单一次获取）：
  - 启动时拉取 historyOrders + todayOrders 合并去重（不按 symbol 拉取）
  - 解析 stockName 归属：使用 monitorSymbol 去掉 .HK 后匹配，RC=牛，RP=熊
  - 自动寻标关闭：按配置标的过滤订单记录
  - 自动寻标开启：以“最新成交标的”（不区分买卖）作为初始标的；若持仓存在则从全量订单中过滤该标的订单并初始化订单记录
  - 若无持仓且无历史标的，则席位为空，满足开盘延迟后立即自动寻标；席位为空时信号直接丢弃
  - 启动顺序：账户/持仓缓存初始化完成后才允许自动寻标

5.寻标时机与交易时段：
  - 自动寻标仅在 canTradeNow=true 时执行
  - 上午开盘延迟 5 分钟后才允许寻标（下午开盘不等待）
  - 启动时先判断持仓，存在持仓则跳过开盘延迟
  - 寻标触发仅在行情价格变化时执行
  - 寻标触发冷却：同方向 30 秒内只允许一次（包含席位为空时的重试）

6.分均成交额计算：
  - 使用 getTradingMinutesSinceOpen 计算已开盘分钟数
  - 13:00 以后分母包含上午 150 分钟
  - 监控标的行情缺失不阻止自动寻标

7.实时换标触发：
  - 仅距回收价比值越界触发换标（包含等于）
  - 距回收价比值计算沿用现有实现
  - 换标仅在行情价格变化时检查
  - 触发换标后立即清空席位并阻断新信号

8.撤单与移仓流程：
  - 先撤销该方向所有未完成买入订单（New/Partial/WaitToNew/WaitToReplace/PendingReplace），撤单完成后才可寻标
  - 撤单失败视为换标失败，席位保持空并记录错误
  - 仅撤销买入挂单，不撤卖出挂单
  - 若仅有未成交买入挂单且无持仓：撤单完成后立即寻标
  - 若 availableQuantity>0：使用 ELO 卖出旧标的全部持仓，完全成交后自动寻标并占位，再用 ELO 买入新标的
  - 移仓买入遵循“接近但小于”原则，数量向下取整到 lotSize
  - 移仓市值上限使用旧标的卖出完全成交后的实际资金
  - 若 availableQuantity=0 但总持仓>0：视为已有卖出挂单未成交，持续等待，不进行寻标
  - 卖出未成交或失败时持续等待，不触发新标的分配
  - 卖出完成后若寻标失败，席位保持空等待下次寻标

9.挂单处理与信号阻断：
  - 换标期间不再生成新的卖出信号
  - 已存在的卖出挂单可继续执行，失败不重新触发移仓卖出
  - 席位为空时买入信号直接丢弃并记录原因
  - 行情未就绪时买入信号直接丢弃并记录“行情未就绪”（不按席位空处理）
  - 卖出无行情允许生成并执行，失败按失败处理

10.缓存刷新与清理：
  - 换标成功后统一刷新顺序：订单记录 → 持仓缓存 → 浮亏监控 → 回收价缓存 → 标的名称
  - 需要移仓的场景在移仓完成后再统一刷新
  - 换标完成后清理旧标的订单记录与 API 缓存，避免污染新席位
  - 换标时清理该方向延迟验证信号与买卖队列
  - 换标期间暂停旧标的方向指标写入并清空 indicatorCache 历史快照
  - warrantQuote 失败视为换标失败，席位保持空并记录错误

11.行情订阅与订单监控：
  - 行情订阅必须支持运行时订阅/退订
  - 寻标成功后立即订阅新标的；订阅失败视为寻标失败
  - 新标的可先占位等待行情到达，等待上限不设
  - 换标完成后旧标的无挂单/无持仓才允许退订，否则保留订阅以便继续监控
  - 订单监控需继续跟踪旧标的挂单直到完成或撤销

12.单方向单标的约束与失败处理：
  - 同一监控标的同方向仅允许一个标的占位，不允许新旧并存
  - 自动寻标失败席位保持空并阻断交易，记录失败日志
  - 做多/做空方向独立处理，成功与失败互不影响
  - 末日保护需覆盖换标过程中的旧标的持仓

13.关闭自动寻标的一致性要求（必须与旧逻辑等价）：
  - 席位由配置标的初始化并保持 READY，不允许进入 EMPTY/SWITCHING
  - 自动寻标与换标流程完全禁用，不触发清空席位、队列清理、指标缓存清理
  - 距回收价比值越界检查仅在自动寻标开启时生效
  - 全量订单拉取后的过滤结果必须与旧版按标的直接拉取一致（时间范围、去重与过滤规则等价）
  - 行情订阅集合固定为监控标的 + 配置标的，不因席位状态动态变更
  - 席位版本校验不应丢弃任何正常信号（版本不变或始终匹配当前席位）